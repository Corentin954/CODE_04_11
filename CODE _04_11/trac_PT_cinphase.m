clearP=load("fichiers/Ptest.txt");T=load("fichiers/Ttest.txt");XA=load("fichiers/XAtest.txt");XB=load("fichiers/XBtest.txt");XC=load("fichiers/XCtest.txt");V=load("fichiers/Vtest.txt");E=load("fichiers/Etest.txt");C=load("fichiers/Ctest.txt");G=load("fichiers/Gtest.txt");Sentropie=load("fichiers/Stest.txt");test_cons_thermo=load("fichiers/test_cons_thermo.txt");P_eq=test_cons_thermo(:,1);T_eq=test_cons_thermo(:,2);C_eq_S=test_cons_thermo(:,3);C_eq_VE=test_cons_thermo(:,4);% Calcul de l'erreur sur la consistance thermoZONE_test=load("fichiers/ZONEtest.txt");%%%%%%%%%%%%%%%%%%%%%%%%[~,ne]=size(E);[~,nv]=size(V);Vmin=min(V);   Vmax=max(V);Emin=min(E);   Emax=max(E);P=reshape(P,ne,nv);T=reshape(T,ne,nv);XA=reshape(XA,ne,nv);XB=reshape(XB,ne,nv);XC=reshape(XC,ne,nv);ZONE_test=reshape(ZONE_test,nv,ne);C=reshape(C,nv,ne);G=reshape(G,nv,ne);Sentropie=reshape(Sentropie,nv,ne);%test_cons_thermo=reshape(test_cons_thermo,nv,ne);P_eq=reshape(P_eq,ne,nv);T_eq=reshape(T_eq,ne,nv);C_eq_S=reshape(C_eq_S,ne,nv);C_eq_VE=reshape(C_eq_VE,ne,nv);ErrP=P-P_eq;ErrT=T-T_eq;ErrC=C_eq_S-C_eq_VE;Nb_ZONE=load("fichiers/Nb_ZONEbench.txt");V_dis=load("fichiers/Vbench_dis.txt");E_dis=load("fichiers/Ebench_dis.txt");[nv_dis,~]=size(V_dis);[ne_dis,~]=size(E_dis);Nb_ZONE=reshape(Nb_ZONE,nv_dis,ne_dis);SA=load("fichiers/pSA.txt");SB=load("fichiers/pSB.txt");SC=load("fichiers/pSC.txt");SAB=load("fichiers/pSAB.txt");SAC=load("fichiers/pSAC.txt");SBC=load("fichiers/pSBC.txt");[na,~]=size(SA); % de taille NA+1 car SA[NA]=S[0] (code C)[nb,~]=size(SB);[nc,~]=size(SC);[nab,~]=size(SAB); % de taille NBA+1 car SA[NA]=S[0] (code C)[nac,~]=size(SAC);[nbc,~]=size(SBC);%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%   %          P(V,E)  figurehold onsurf(V*1e6,E,P*1e-9);%%contour(V*1e6,E,P,50);%%pcolor(V*1e6,E,P);%%contourf(V*1e6,E,P*1e-9,[0:2:70]);%contourf(V*1e6,E,P*1e-9,100);%% ploynomes##S=SA;##plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');S=SAB;plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');S=SAC;plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');S=SBC;plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');xlabel("V (cm^3/kg)");ylabel("E (J/kg)");xlim([Vmin, Vmax]*1e6);ylim([Emin, Emax]);grid()set(gca, "fontsize", 40)title("P(V,E)");hold off######%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%####               T(V,E)figurehold onsurf(V*1e6,E,T);%%contour(V*1e6,E,T,50);%%pcolor(V*1e6,E,T);w%contourf(V*1e6,E,T,[300:50:2500]);%contourf(V*1e6,E,T,100);%% ploynomesS=SAB;plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');S=SAC;plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');S=SBC;plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');xlabel("V (cm^3/kg)");ylabel("E (J/kg)");xlim([Vmin, Vmax]*1e6);ylim([Emin, Emax]);grid()set(gca, "fontsize", 40)title("T(V,E)");hold off%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%m�               C(V,E)figurehold onsurf(V*1e6,E,C);%%contour(V*1e6,E,C,50);%%pcolor(V*1e6,E,C);%contourf(V*1e6,E,C,100);% ploynomesn=nab-1;S=SAB;plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');n=nac-1;S=SAC;plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');n=nbc-1;S=SBC;plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');xlabel("V (cm^3/kg)");ylabel("E (J/kg)");zlabel("vitesse du son (m/s)");%zlim([-1.1e3,6e3])xlim([Vmin, Vmax]*1e6);ylim([Emin, Emax]);grid()set(gca, "fontsize", 40)title("C(V,E)");hold off################%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%########               Erreur sur les methodes de calcul de P##figure##hold on##surf(V*1e6,E,ErrP);##%contourf(V*1e6,E,test_cons_thermo,100);##%% ploynomes##S=SAB;##plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');##S=SAC;##plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');##S=SBC;##plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');##xlabel("V (cm^3/kg)");##ylabel("E (J/kg)");##xlim([Vmin, Vmax]*1e6);##ylim([Emin, Emax]);##grid()##set(gca, "fontsize", 40)##title("P(newton 3 phases) - P(explicite ou newton 2 phases)");##hold off##################%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%########               Erreur sur les types de calcul de T ##figure##hold on##surf(V*1e6,E,ErrT);##%contourf(V*1e6,E,test_cons_thermo,100);##%% ploynomes##S=SAB;##plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');##S=SAC;##plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');##S=SBC;##plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');##xlabel("V (cm^3/kg)");##ylabel("E (J/kg)");##xlim([Vmin, Vmax]*1e6);##ylim([Emin, Emax]);##grid()##set(gca, "fontsize", 40)##title("T(newton 3 phases) - T(explicite ou newton 2 phases)");##hold off##################%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%########               Erreur sur les types de calcul de C ##figure##hold on##surf(V*1e6,E,ErrC);##%contourf(V*1e6,E,test_cons_thermo,100);##%% ploynomes##S=SAB;##plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');##S=SAC;##plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');##S=SBC;##plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');##xlabel("V (cm^3/kg)");##ylabel("E (J/kg)");##xlim([Vmin, Vmax]*1e6);##ylim([Emin, Emax]);##grid()##set(gca, "fontsize", 40)##title("C=-V²(dP/dV)_S - C=-V²(dP/dV - PdP/dE)");##hold off##################%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%########               C=-V²(dP/dV)_S##figure##hold on##surf(V*1e6,E,C_eq_S);##%contourf(V*1e6,E,test_cons_thermo,100);##%% ploynomes##S=SAB;##plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');##S=SAC;##plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');##S=SBC;##plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');##xlabel("V (cm^3/kg)");##ylabel("E (J/kg)");##xlim([Vmin, Vmax]*1e6);##ylim([Emin, Emax]);##grid()##set(gca, "fontsize", 40)##title("C=-V²(dP/dV)_S");##hold off##################%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%########              C=-V²(dP/dV - PdP/dE)##figure##hold on##surf(V*1e6,E,C_eq_VE);##%contourf(V*1e6,E,test_cons_thermo,100);##%% ploynomes##S=SAB;##plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');##S=SAC;##plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');##S=SBC;##plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');##xlabel("V (cm^3/kg)");##ylabel("E (J/kg)");##xlim([Vmin, Vmax]*1e6);##ylim([Emin, Emax]);##grid()##set(gca, "fontsize", 40)##title("C=-V²(dP/dV - PdP/dE)");##hold off%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%               XA  fraction massiquefigurehold on%surf(V*1e6,E,X);%contour(V*1e6,E,X,50);%pcolor(V*1e6,E,X);contourf(V*1e6,E,XA,[0:0.1:1]);% ploynomesS=SAB;plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');S=SAC;plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');S=SBC;plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');xlabel("V (cm^3/kg)");ylabel("E (J/kg)");xlim([Vmin, Vmax]*1e6);ylim([Emin, Emax]);grid()set(gca, "fontsize", 40)title("fraction massique de la phase A dans les zones de m�lange");hold off%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%##%               XB  fraction massiquefigurehold on%surf(V*1e6,E,X);%contour(V*1e6,E,X,50);%pcolor(V*1e6,E,X);contourf(V*1e6,E,XB,[0:0.1:1]);% ploynomesS=SAB;plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');S=SAC;plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');S=SBC;plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');xlabel("V (cm^3/kg)");ylabel("E (J/kg)");grid()set(gca, "fontsize", 40)title("fraction massique de la phase A dans les zones de m�lange");hold off%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%##%               XC  fraction massiquefigurehold on%surf(V*1e6,E,X);%contour(V*1e6,E,X,50);%pcolor(V*1e6,E,X);contourf(V*1e6,E,XC,[0:0.1:1]);% ploynomesS=SAB;plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');S=SAC;plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');S=SBC;plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');xlabel("V (cm^3/kg)");ylabel("E (J/kg)");grid()set(gca, "fontsize", 40)title("fraction massique de la phase C dans les zones de m�lange");hold off%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%             Zones par mailles   figurehold onsurf(V*1e6,E,ZONE_test);%%%%% ploynomesS=SAB;plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');S=SAC;plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');S=SBC;plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');xlabel("V (cm^3/kg)");ylabel("E (J/kg)");grid()set(gca, "fontsize", 40)title("Nb zone par case");hold off%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%             Nombre de zones par mailles   figurehold on%%%% ploynomesn=na-1;S=SA;plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');n=nb-1;S=SB;plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');n=nc-1;S=SC;plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');n=nab-1;S=SAB;plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');n=nac-1;S=SAC;plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');n=nbc-1;S=SBC;plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');% grillehe=E_dis(2)-E_dis(1);Edeb=E_dis(1)-he/2;Efin=E_dis(ne_dis)+he/2;hv=V_dis(2)-V_dis(1);Vdeb=V_dis(1)-hv/2;Vfin=V_dis(nv_dis)+hv/2;for i=1:nv_dis  Vplot=Vdeb+i*hv;  plot([Vplot Vplot]*1e6,[Edeb Efin]);endfor i=1:ne_dis+1  Eplot=Edeb+i*he;  plot([V_dis(1) V_dis(nv_dis)]*1e6,[Eplot Eplot]);end% plotsurf(V_dis*1e6,E_dis,Nb_ZONE) %,'marker','o');%contour(V*1e6,E,P,50);%pcolor(V*1e6,E,P);%contourf(V*1e6,E,P*1e-9,[0:2:70]);%contourf(V*1e6,E,Nb_ZONE,100);xlabel("V (cm^3/kg)");ylabel("E (J/kg)");grid()set(gca, "fontsize", 40)title("Nb zone par case");hold off%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%m�               G(V,E)figurehold onsurf(V*1e6,E,G);%%contour(V*1e6,E,C,50);%%pcolor(V*1e6,E,C);%contourf(V*1e6,E,C,100);% ploynomesn=nab-1;S=SAB;plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');n=nac-1;S=SAC;plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');n=nbc-1;S=SBC;plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');xlabel("V (cm^3/kg)");ylabel("E (J/kg)");zlabel("G ");%zlim([-1.1e3,6e3])xlim([Vmin, Vmax]*1e6);ylim([Emin, Emax]);grid()set(gca, "fontsize", 40)title("derivee fondamentale  G(V,E)");hold off%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%m�               S(V,E)figurehold onsurf(V*1e6,E,Sentropie);%%contour(V*1e6,E,C,50);%%pcolor(V*1e6,E,C);%contourf(V*1e6,E,C,100);% ploynomesn=nab-1;S=SAB;plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');n=nac-1;S=SAC;plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');n=nbc-1;S=SBC;plot(S(:,1)*1e6,S(:,2), "linewidth",0.5,"color",'black');xlabel("V (cm^3/kg)");ylabel("E (J/kg)");zlabel("S");%zlim([-1.1e3,6e3])xlim([Vmin, Vmax]*1e6);ylim([Emin, Emax]);grid()set(gca, "fontsize", 40)title("Entropie  S(V,E)");hold off