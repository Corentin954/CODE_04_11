% Solution exacte AVERAGE du cas-test limite onde acoustique au temps initiale% pour comparaison apres une période% n : nx+1% ind_grille : 0 - schémas centrés en espace (Godunov)%              1 - schémas décalés en espace function [ TAUbar, RHObar,Ubar, RTAUbar, RUbar, REPSbar]=sol_ordre(a,b,nx,fac_eps,ind_grille)     format long % permet d'avoir une dizaine de chiffre significatif gamma= 7/5;h=(b-a)/nx;Xd=a:h:b;Xu=(a-h/2):h:(b+h/2);    % Planar Kidder kappa=2*pi;rho0=1.0; p0=5./7;rho_bar=@(a,b)  rho0 - (fac_eps/(kappa*(b-a)))*(cos(kappa*b) - cos(kappa*a));u_bar=@(a,b)  -(fac_eps/(kappa*(b-a)))*(cos(kappa*b) - cos(kappa*a));p_bar=@(a,b)  p0 - (fac_eps/(kappa*(b-a)))*(cos(kappa*b) - cos(kappa*a));rho_ana=@(x)  rho0 + fac_eps*sin(kappa*x);tau_ana=@(x)  1./(rho0 + fac_eps*sin(kappa*x));u_ana=@(x)  fac_eps*sin(kappa*x);p_ana=@(x)  p0 + fac_eps*sin(kappa*x);rho_eps_ana=@(x) (p0 + fac_eps*sin(kappa*x))/(gamma-1);rho_u_ana=@(x) (rho0 + fac_eps*sin(kappa*x))*fac_eps*sin(kappa*x);tol=[1e-12,1e-12];%%  RHO et PRHObar=zeros(1,nx); RTAUbar=zeros(1,nx); REPSbar=zeros(1,nx); for i=1:nx   RHObar(i)=rho_bar(Xd(i),Xd(i+1));    TAUbar(i)=quad(tau_ana,Xd(i),Xd(i+1),tol)/h;    REPSbar(i)=1.0;  REPSbar(i)=quad(rho_eps_ana,Xd(i),Xd(i+1),tol)/h;endforRUbar=zeros(1,nx+1); for i=1:nx+1   RUbar(i)=quad(rho_u_ana,Xu(i),Xu(i+1),tol)/h;endfor%%  Uif(ind_grille==0) % u centré en espace  Ubar=zeros(1,nx);   for i=1:nx      Ubar(i)=u_bar(Xd(i),Xd(i+1));  endforelseif(ind_grille==1) % u décalé en espace  Ubar=zeros(1,nx+1);   for i=1:nx+1      Ubar(i)=u_bar(Xu(i),Xu(i+1));  endfor  end    endfunction